% 功率因子为0.05
%% 512x16，BER
clear ;
clc 
close all;
snr=-0:2:14;
% subplot(2,1,1);
NO_ce_xu = [0.1722	0.1184	0.07139	0.03401	0.01199	0.002915	0.0004413	3.4e-5];
Has_ce_xu = [0.2291	0.1588	0.09549	0.04597	0.01661	0.003971	0.0005681	4.2e-5];
NO_ce_cai = [0.172908	0.1200823	0.0719867	0.03435961	0.012339	0.0028858	0.0004208	3.10546875e-05];
Has_ce_cai = [0.2154861328125	0.14958427734375	0.08873232421875	0.0429537109375	0.01550615234375	0.0038724609375	0.00058291015625	5.244140625e-05];

semilogy(snr,NO_ce_xu,'K:o',snr,Has_ce_xu,'r:^',snr,NO_ce_cai,'K-o',snr,Has_ce_cai,'r-^','LineWidth',2);
xlabel('SNR');
ylabel('512x16--BER');
legend('BER--NO ce xu','BER--Has ce xu','BER--NO ce cai','BER--Has ce cai');
title('BER')

%% 512x16，MSE
snr=-0:2:14;
% grid on;  
% subplot(2,1,2);
NO_ce_xu = [0.6255	0.5413	0.4361	0.3305	0.2443	0.1947	0.1698	0.1576];
Has_ce_xu = [0.8223	0.7175	0.5791	0.4261	0.3036	0.228	0.1892	0.1695];
NO_ce_cai = [0.6474175	0.51735365	0.3778	0.237380	0.13557	0.07480	0.04466	0.028548];
Has_ce_cai = [0.72713983	0.5777151	0.41697302	0.2720628	0.16599037	0.109470874	0.081065595	0.066237524];

semilogy(snr,NO_ce_xu,'K:o',snr,Has_ce_xu,'r:^',snr,NO_ce_cai,'K-o',snr,Has_ce_cai,'r-^','LineWidth',2);
xlabel('SNR');
ylabel('512x16--MSE');
legend('MSE--NO ce xu','MSE--Has ce xu','MSE--NO ce cai','MSE--Has ce cai');
title('MSE')

%% 512x32，BER
clear ;
clc 
close all;
snr=-0:2:14;
% subplot(2,1,1);
NO_ce_xu = [0.1707	0.1181	0.07066	0.03434	0.0124	0.003073	0.0004799	4.605e-05];
Has_ce_xu = [0.2622	0.1884	0.1142	0.05609	0.02041	0.004927	0.0007544	6.78e-5];
NO_ce_cai = [0.172449	0.119562	0.071657	0.0341407	0.01170	0.00257749	0.0003083	2.0263671875e-05];
Has_ce_cai = [0.24243525390625	0.1705501953125	0.10272412109375	0.04943193359375	0.01751962890625	0.00423193359375	0.00062421875	5.625e-05];

semilogy(snr,NO_ce_xu,'K:o',snr,Has_ce_xu,'r:^',snr,NO_ce_cai,'K-o',snr,Has_ce_cai,'r-^','LineWidth',2);
xlabel('SNR');
ylabel('512x32--BER');
legend('BER--NO ce xu','BER--Has ce xu','BER--NO ce cai','BER--Has ce cai');
title('BER')

%% 512x32，MSE
snr=-0:2:14;
% grid on;  
% subplot(2,1,2);
NO_ce_xu = [0.7716	0.7086	0.6195	0.5156	0.4237	0.3636	0.3324	0.3172];
Has_ce_xu = [1.011	0.9526	0.8372	0.6811	0.5323	0.4273	0.3709	0.3411];
NO_ce_cai = [0.87508	0.73801	0.57153	0.386708	0.23332	0.13708	0.08465	0.05571];
Has_ce_cai = [0.9845392	0.85791177	0.6800573	0.4783969	0.31894743	0.22743446	0.18082656	0.15652457];

semilogy(snr,NO_ce_xu,'K:o',snr,Has_ce_xu,'r:^',snr,NO_ce_cai,'K-o',snr,Has_ce_cai,'r-^','LineWidth',2);
xlabel('SNR');
ylabel('512x32--MSE');
legend('MSE--NO ce xu','MSE--Has ce xu','MSE--NO ce cai','MSE--Has ce cai');
title('MSE')

%% 512x64，BER
clear ;
clc 
close all;
snr=-0:2:14;
% subplot(2,1,1);
NO_ce_xu = [0.1713	0.1181	0.07153	0.03538	0.01367	0.003845	0.0007652	0.0001185];
Has_ce_xu = [0.3032	0.2275	0.1469	0.0756	0.02913	0.007773	0.001473	0.0001966];
NO_ce_cai = [0.17203408203125	0.11933291015625	0.07203974609375	0.03554453125	0.01346240234375	0.0035849609375	0.00063125	7.998046875e-05];
Has_ce_cai = [0.27940546875	0.20327451171875	0.12645966796875	0.0636478515625	0.02436904296875	0.00674541015625	0.00136650390625	0.00021484375];

semilogy(snr,NO_ce_xu,'K:o',snr,Has_ce_xu,'r:^',snr,NO_ce_cai,'K-o',snr,Has_ce_cai,'r-^','LineWidth',2);
xlabel('SNR');
ylabel('512x64--BER');
legend('BER--NO ce xu','BER--Has ce xu','BER--NO ce cai','BER--Has ce cai');
title('BER')

%% 512x64，MSE
% grid on;  
% subplot(2,1,2);
snr=-0:2:14;
NO_ce_xu = [0.8735	0.8336	0.7725	0.694	0.6188	0.5636	0.5323	0.5168];
Has_ce_xu = [1.093	1.08	1.024	0.9116	0.7745	0.6611	0.5928	0.5551];
NO_ce_cai = [0.9079402	0.8215456	0.6988634	0.5457253	0.40533248	0.30387303	0.2431174	0.20691687];
Has_ce_cai = [1.0629121	1.0222447	0.93784356	0.79477024	0.64276034	0.537081	0.47936973	0.44855404];

semilogy(snr,NO_ce_xu,'K:o',snr,Has_ce_xu,'r:^',snr,NO_ce_cai,'K-o',snr,Has_ce_cai,'r-^','LineWidth',2);
xlabel('SNR');
ylabel('512x64--MSE');
legend('MSE--NO ce xu','MSE--Has ce xu','MSE--NO ce cai','MSE--Has ce cai');
title('MSE')


%% BER对比
snr=-0:2:14;
ce_xu_16 = [0.2291	0.1588	0.09549	0.04597	0.01661	0.003971	0.0005681	4.2e-5];
ce_xu_32 = [0.2622	0.1884	0.1142	0.05609	0.02041	0.004927	0.0007544	6.78e-5];
ce_xu_64 = [0.3032	0.2275	0.1469	0.0756	0.02913	0.007773	0.001473	0.0001966];
ce_cai_16 = [0.2154861328125	0.14958427734375	0.08873232421875	0.0429537109375	0.01550615234375	0.0038724609375	0.00058291015625	5.244140625e-05];
ce_cai_32 = [0.24243525390625	0.1705501953125	0.10272412109375	0.04943193359375	0.01751962890625	0.00423193359375	0.00062421875	5.625e-05];
ce_cai_64 = [0.27940546875	0.20327451171875	0.12645966796875	0.0636478515625	0.02436904296875	0.00674541015625	0.00136650390625	0.00021484375];

semilogy(snr,ce_xu_16,'K:o',snr,ce_xu_32,'b:o',snr,ce_xu_64,'r:o',snr,ce_cai_16,'K-^',snr,ce_cai_32,'b-^',snr,ce_cai_64,'r-^','LineWidth',2);
xlabel('SNR');
ylabel('CE--BER');
legend('XU-BER-CE(CSI=16)','XU-BER-CE(CSI=32)','XU-BER-CE(CSI=64)','DL-BER-CE(CSI=16)','DL-BER-CE(CSI=32)','DL-BER-CE(CSI=64)');
title('BER')

%% MSE对比
snr=-0:2:14;
ce_xu_16 = [0.8223	0.7175	0.5791	0.4261	0.3036	0.228	0.1892	0.1695];
ce_xu_32 = [1.011	0.9526	0.8372	0.6811	0.5323	0.4273	0.3709	0.3411];
ce_xu_64 = [1.093	1.08	1.024	0.9116	0.7745	0.6611	0.5928	0.5551];
ce_cai_16 = [0.72713983	0.5777151	0.41697302	0.2720628	0.16599037	0.109470874	0.081065595	0.066237524];
ce_cai_32 = [0.9845392	0.85791177	0.6800573	0.4783969	0.31894743	0.22743446	0.18082656	0.15652457];
ce_cai_64 = [1.0629121	1.0222447	0.93784356	0.79477024	0.64276034	0.537081	0.47936973	0.44855404];

semilogy(snr,ce_xu_16,'K:o',snr,ce_xu_32,'b:o',snr,ce_xu_64,'r:o',snr,ce_cai_16,'K-^',snr,ce_cai_32,'b-^',snr,ce_cai_64,'r-^','LineWidth',2);
xlabel('SNR');
ylabel('CE--MSE');
legend('XU-MSE-CE(CSI=16)','XU-MSE-CE(CSI=32)','XU-MSE-CE(CSI=64)','DL-MSE-CE(CSI=16)','DL-MSE-CE(CSI=32)','DL-MSE-CE(CSI=64)');
title('MSE')